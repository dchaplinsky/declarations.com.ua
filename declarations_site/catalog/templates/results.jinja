{% extends "base.jinja" %}
{% from "_search_results.jinja" import search_results with context %}
{% from "_search_form.jinja" import ex_search_form %}
{% from "_spotter.jinja" import spotter_button -%}

{% block extrahead %}
{% if results.has_previous() %}<link rel="prev" href="?{{ updated_querystring(request, {'page': results.previous_page_number()}) }}" />{% endif %}
{% if results.has_next() %}<link rel="next" href="?{{ updated_querystring(request, {'page': results.next_page_number()}) }}" />{% endif %}
{% if request.META['QUERY_STRING'] %}
<link href="{{ request.get_full_path() }}&amp;format=rss" rel="alternate" type="application/rss+xml" title="{{ _("Результати пошуку") }} '{{ query }}' {{ _("в RSS 2.0") }}" />
<link href="{{ request.get_full_path() }}&amp;format=atom" rel="alternate" type="application/atom+xml" title="{{ _("Результати пошуку") }} '{{ query }}' {{ _("в Atom") }}" />
{% endif %}
{% endblock %}

{% block html_desc %}{% if meta %}{{ meta.description }}{% else %}{{ super() }}{% endif %}{% endblock %}
{% block html_title %}{% if meta %}{{ meta.title }}{% else %}{{ super() }}{% endif %}{% endblock %}

{% block bodyclass %}not-front search-page{% endblock %}

{% block content %}

{{ ex_search_form(query, deepsearch) }}

<section id="page">
    <div class="compare-list container hidden">
        <h2>{{ _("Список порівнянь:") }}</h2>
        <div class="row"></div>

    </div>
    <div class="container">
        <div id='div-gpt-ad-1531830029689-0' style="display: none; width: 970px; margin: 15px auto;">
            <script>
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1531830029689-0'); });
            </script>
        </div>
    </div>
    <div class="container rc">
        <div class="breadcrumbs-container">
            <div id="breadcrumbs">
                <ol class="breadcrumb pull-left">
                    <li><a href="{{ url("wagtail_serve", "") }}">{{ _("Головна") }}</a></li>
                    <li class="active">{{ _("Результати пошуку") }}</li>
                </ol>
            </div>

            <h1 id="page-header"><span>{{ query|default("Всі", true)|escape }} ({{ results.paginator.count }})</span></h1>
        </div>

        {% if request.META['QUERY_STRING'] %}
        <div class="watching-block">
            <p>{{ _("Моніторити цей запит по:") }}</p>
            <a title="Моніторити цей запит по RSS" class="btn btn-raised btn-sm save-search rss-feed" href="{{ SITE_URL }}{{ request.get_full_path() }}&amp;format=rss"><i class="fa fa-rss" aria-hidden="true"></i> RSS</a>
            {{ spotter_button(_("Моніторити цей запит"), request.META['QUERY_STRING'], "from-search") }}
        </div>
        {% endif %}

        <div class="page-content">
            <div class="btn-group toggle-view">
                <a href="#" id="list" class="btn btn-default btn-sm">
                    <span class="glyphicon glyphicon-th-list"></span> {{ _("Списком") }}
                </a>
                <a href="#" id="grid" class="btn btn-default btn-sm">
                    <span class="glyphicon glyphicon-th"></span> {{ _("Картками") }}
                </a>
            </div>

            <div class="toggle-search">
                <span>{{ _("Сортувати:") }}</span>
                    <div class="btn-group">
                        <a href="?{{ replace_arg(request, 'sort', 'name', 'name_desc') }}" id="sort-name" class="btn btn-default btn-sm">{{ _("П.І.Б.") }} {{ sort_flag(request, 'sort', 'name', 'name_desc') }}</a>
                        <a href="?{{ replace_arg(request, 'sort', 'year_desc', 'year') }}" id="sort-year" class="btn btn-default btn-sm">{{ _("Рік") }} {{ sort_flag(request, 'sort', 'year', 'year_desc') }}</a>
                        <a href="?{{ replace_arg(request, 'sort', 'date_desc', 'date') }}" id="sort-year" class="btn btn-default btn-sm">{{ _("Дата подачі") }} {{ sort_flag(request, 'sort', 'date', 'date_desc') }}</a>
                  </div>
            </div>

            <div class="row list-group search-results">
                {{ search_results(results) }}
            </div>

            {% if results.paginator.num_pages > 1 %}
            <ul class="pagination">
                <li{% if not results.has_previous() %} class="disabled"{% endif %}><a href="{% if results.has_previous() %}?{{ updated_querystring(request, {'page': results.previous_page_number()}) }}{% endif %}">«</a></li>
                {% for page_num in results.contextual_page_range %}
                {% if page_num == None %}
                    <li class="disabled"><a href="#">&hellip;</a></li>
                {% else %}
                    <li{% if results.number == page_num %} class="active"{% endif %}><a href="?{{ updated_querystring(request, {'page': page_num}) }}">{{ page_num }}</a></li>
                {% endif %}
                {% endfor %}
                <li{% if not results.has_next() %} class="disabled"{% endif %}><a href="{% if results.has_next() %}?{{ updated_querystring(request, {'page': results.next_page_number()}) }}{% endif %}">»</a></li>
            </ul>
            {% endif %}
    </div>
</section>

{% endblock %}